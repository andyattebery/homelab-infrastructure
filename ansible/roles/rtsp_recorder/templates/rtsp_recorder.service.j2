[Unit]
Description=Record RTSP stream {{ rtsp_stream_name }}
Requires={{ rtsp_recorder_systemd_requires }}
After={{ rtsp_recorder_systemd_after }}

[Service]
Type=exec
ExecStart=ffmpeg -hide_banner -y -loglevel error -rtsp_transport tcp -use_wallclock_as_timestamps 1 -i {{ rtsp_stream_url }} -vcodec copy -acodec copy -f segment -reset_timestamps 1 -segment_time 300 -segment_format mkv -segment_atclocktime 1 -strftime 1 "{{ rtsp_stream_recording_directory }}/{{ rtsp_stream_name }}_%%Y%%m%%dT%%H%%M%%S.mkv"
Restart=on-failure

[Install]
WantedBy=multi-user.target
